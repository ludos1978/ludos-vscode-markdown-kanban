## Feature requirements

### Content Elements
- Column Titles
  - Task Titles
  - Task Descriptions

## The structure of the Content Elements is as this:
- Horizontal Rows allow Columns to be structured into vertically limited height groups. Each Row can have any number of Stacks
- Vertical Stacks allow combing Columns in a vertical Group. Any Column without a #stack tag is put on an new Stack, any Column with a #stack tag stays on the same Stack as the previous Column.

Any of the "Content Elements" can be edited by the User.

### Content Editing Methods
There are multiple Types of content editing
- Inline Editor
  - in markdown mode (plain text markdown)
  - wysiwyg editor mode (visual editor, but entry is only using keyboard)
- Overlay Editor
  - in markdown mode
  - dual pane markdown mode, with realtime preview and some editing modes
  - wysiwyg editor with buttons for formatting and inserts.

### Content Editor
- can use VS Code shortcuts to insert snippets (meta/ctrl/alt/shift combinations)
- supports undo/redo in editors
- All embed/link types (Link, Image, Include and Wiki) have a burger menu with consistent actions. Alt+Click opens in VS Code first, and falls back to the system editor.
  - Open (in VS Code if available, otherwise in the system defined tool)
  - Reveal in File Explorer
  - Search for Replacement File
  - Browse for Replacement File
  - Convert to Relative or Absolute Path
  - Delete
- All dynamic diagrams have a burger menu with multiple actions.
  - Convert to SVG
  - Copy SVG to Clipboard
  - Copy Markdown Code

### Top bar

#### Left
- Filename
- Yaml header settings
  - Marp Options
  - Pandoc Options

#### Middle 
- Card drop source
- Column drop source

#### Right
- Column folding
- Column header stickyness
- Card sorting
- Active processes
- Save state
- Layout Templates
- Main burger Menu

### General Drag & Drop
Dragging and Dropping allows the creation of Tasks from Drop Sources or reordering Tasks and Columns within the Kanban Board. 

#### Importing
External Drop sources can be files from the VsCode Explorer. 
Files from outside the Editor (which opens a import dialogue ).
Indirectly clipboard data (via the drop sources).

### File Import Dialogue
To keep files from duplicating the kanban board keeps a hashes of files in the workspaces. If a file is found in the hashes which is dropped into the kanban it can be linked into the kanban. If the file is not found it can be created from the data in the Media folder. This is needed because a vscode plugin cannot access the filepath of a dropped file, only it's content.

Dialogue Options:
- Link existing file (if it's found in the hash database, othervise disabled)
- Copy file to Media folder (if the file is not found in the hash database, othervise it's disabled)
- Search for file (by filename)
- Open Media folder (in System File Explorer to manually move it) 
- Cancel
Copying a file to the Media folder updates the hash database.

### Hash Database (MediaIndex)
It keeps a hash of media files that can be used in the kanban, preventing duplicates. The hash is generated by the first megabyte of the file data, the last modification time and the filesize.

The hash database can scan (keep an index of):
- the media folder(s) of the main file and the included markdown files
- whole folder and all subfolders of the main file and the included markdown files
- all workspaces.
This scan scope is configurable.

### Drop Sources for Columns
Column Drop sources can be dropped anywhere in the board
- Empty column
- Column from clipboard data
- Column from templates

### Drop Sources for Tasks
Task Drop sources can be dropped in all Tasks
- Empty task
- Task from clipboard data (can handle binary images, which creates them in a {filename}-Media folder)
- Empty excalidraw & drawio diagrams

### Column Templates
Column templates allow creating templates of multiple columns that can be dropped somewhere in the kanban board.

### WYSIWYG Editor
- if a text is selected and the link-button or the image-button is clicked, the text is classified (filename/path vs normal text) and placed in the right part of the link, keeping the selection.
- if a text is selected and any of the styling buttons are pressed, the style is applied and the selection stays.
- link/image/include/wiki elements are editable via the burger menu.
- if "show marp features" is active. then have all the marp classes available to activate in the editor which we also have on the burger menu of the task.
- the standard styling options and all important markdown features must be available to select from the button-menu:
  - B, I, U, S, Mark, Sub, Sup (text style)
  - Link, Image, Include, Wiki (embed/link)
  - Code, Block, Footnote, Columns (block-style), Tables
- it must be possible to put new content inside, before and after all blocks (and on the same line). putting content into an object differs for each type.
  - image/document/video link has at least 3 elements [alt-text](link "description")
  - includes and wiki-link use the same burger menu as the image/document/video links. but they dont have a alt text or a description.
  - code might also be mermaid or plantuml diagrams and must render as such.
  - columns can be modified in the number of columns (-/+ in the top corners). The ---: :--: :--- must be on separate newlines.

### Markdown / Marp file including

Using the !!!include(filename.md)!!! a Marp presentation can be imported and directly edited from within the Kanban Board.
The include statement can be added to the Column Header (best for large presentations), the Task Header (smaller data) or directly into a Task Content (content is read-only).

### Tags
- Tags are written as #tag in titles or descriptions.
- Tags can be colorized and categorized.
- Tag visibility can be toggled (show all, hide, or only show for layout tags).
- Tag configuration can be used in templates and formatting.

### Export
- Export board content using Marp or Pandoc integrations.
- Export options are controlled via YAML header settings.
- Export respects include files and embedded assets.

#### Marp 
- Uses the Marp engine to generate slide decks from tasks/columns.
- Theme and class settings can be configured from the YAML header.

#### Pandoc
- Uses Pandoc to export to additional formats.
- Pandoc binary path and options can be configured in settings.

### Sorting
- Manual sorting via drag & drop.
- Optional sorting tools from the top bar.

### Visual File Embeddings

Files can be embedded using ![alt-text](/path/to/file.jpg "text to image") . All browser supported images are working, also videos (only a few audio codecs) and DrawIo and Excalidraw.

A Burger Menu allows modification of path. Seaching for alternatives if a filepath is broken.


### DrawIo, Excalidraw

These types of diagrams can be directly added to the board, they will render to a cached image which is displayed in the Kanban. Alt+Clicking allows to edit them. A burger menu allows other modifications of the filename.


### Search and Broken file finding
- Broken links/images show a visible state.
- Burger menu actions can search or browse for a replacement file.
- Search can be done by filename and updates the path inline.
