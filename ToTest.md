# ToTest

- [ ] Verify tag menus still list active tags correctly for columns and tasks, including custom groups and active-tag overrides.
- [ ] Toggle the debug button (version menu) and confirm regular logs stop when debug is disabled while `WebviewBridge` warnings and errors still appear in the console when debug mode is on.
- [ ] Verify task menu actions still execute (move top/up/down/bottom, move to column list, and sort options).
- [ ] Verify video/audio embeds resolve multiple <source> tags correctly (relative, absolute, include-based paths) and keep the path menu overlay.
- [ ] Verify image/PDF/diagram placeholders still render and resolve paths in includes and main files.
- [ ] Open the search panel and export options to confirm hidden sections toggle visible as expected.
- [ ] Close the kanban panel (or switch files) several times and confirm no "Unbound disposable context" errors appear in the extension host logs, indicating FileRegistryChangeHandler disposes cleanly.
- [x] Start dragging a task, press Esc (or cancel drag), and confirm it snaps back with no stuck drag state.
- [ ] Drag a task outside the board and re-enter to confirm drop indicators recover (no stuck "left view" state). -> this FAILS
- [ ] Drag clipboard/empty/diagram cards onto the board and confirm indicators show and drag state resets (no lingering drag highlights).
- [ ] Drag internal columns/tasks and confirm external file drop indicators do not appear.
- [ ] Drag a task within the board and confirm external file handling stays inactive.
- [ ] Drag external files over the board, drop to create cards, then leave or drop outside; confirm indicators and highlights clear.
- [ ] Drag template/empty/clipboard columns onto the board and confirm drop zones, creation, and drag cleanup behave normally.
- [ ] Drop external files or clipboard cards and confirm tasks are created without console errors about drop feedback cleanup.
- [ ] Verify column headers are rendered through markdown-it so markup (e.g., `## Title`) displays as rich text and include badges still appear instead of raw markdown.
- [ ] Drag a diagram card (Excalidraw/Draw.io) and confirm the filename prompt is centered, validates invalid characters, and creates the task after confirmation.
- [x] Trigger the file search modal (broken link flow) and confirm it opens/closes without console errors.
- [x] Open the diagram filename prompt and confirm it is at least 200px wide and centered.
- [x] Open the diagram filename prompt and confirm the input field spans the modal width.
- [ ] Reorder a column within the same row and confirm the column order updates without losing any columns.
- [ ] Move a column between rows and confirm the #row tag updates correctly in the column title.
- [ ] Insert an empty column before/after another column and confirm #row/#stack tags match the target row/stack.
- [ ] Run a text search with HTML-like characters in titles/descriptions and confirm the search panel renders results without broken markup.
- [ ] Open the file search modal with a path containing special characters (&, <, >, quotes) and confirm it renders safely.
- [ ] Drag a column and confirm before/between/after drop zones appear and accept the drop.
- [ ] Open the extension settings and confirm remaining options are grouped by how often a user would change them (frequent first, advanced last).
- [ ] Toggle the new Marp settings visibility option in the file bar menu and verify the global Marp burger plus column/task Marp submenu items hide/show accordingly, confirm the document-level preference stays sticky (reopen or switch back to the board) via the new `setFilePreference` storage, and ensure no `setPreference` errors appear in the console.
- [ ] Adjust the font size control from the file bar menu (or settings) so the board text scales, confirm the preference is stored under `markdown-kanban.fontSize`, and check the console for the absence of `setPreference` errors when switching values.
- [ ] Open any burger menu (e.g., task or column actions) and confirm the dropdown uses the configured minimum width (â‰ˆ200px) so items do not overflow, then open a submenu and verify the repositioned panel stays within the screen bounds.
- [ ] Verify the submenu's arrow and surrounding area stay totally within the dropdown background so there are no floating pointers or clipped highlights.
- [ ] Toggle the new Show special characters option in the file bar menu and confirm spaces, tabs, newline, and carriage return indicators appear and disappear on task titles and descriptions.
- [ ] While editing a task title or description, press Shift+Tab from a mid-line cursor and confirm it removes a tab or two spaces at the cursor position (not just at the line start).
- [ ] With the special characters toggle enabled, confirm no markers are visible while viewing tasks normally, and that they appear only after entering edit mode (then disappear again when editing ends).
- [ ] Enable the show-special-characters toggle while editing and verify the glyph overlay is limited to the currently active editor, not leaking onto other display-only text fields or other editors.
- [ ] With show-special-characters enabled, make sure the caret stays aligned with the visible characters/mapping glyphs (any padding/font differences should be copied from the edit field).
- [ ] Select text, press *, _, ~, [, (, or { and confirm the editor adds the matching start/end characters around the selection while keeping it highlighted; with no selection the keys should just insert their character.
- [ ] In the WYSIWYG editor, select text and press *, _, ~, [, (, or { and confirm the selection stays highlighted and gets wrapped with the matching characters.
- [ ] On keyboard layouts where ~ is a dead key (e.g., Alt+N then Space), confirm ~ inserts normally with no selection, wraps selected text when pressed with a selection, and does not insert an extra ~ afterward.
- [ ] Open the debug overlay and confirm the main file path shown comes from the registry (matches the real file), and that Force Save All reports an error if no main file is registered.
- [ ] Use Reload All Included Files and confirm include files reload from disk and the file list stays correct in the debug overlay.
- [ ] Review docs/wysiwyg-mapping.md and confirm all markdown-it plugins/custom syntaxes are captured in the mapping plan.
- [ ] Review the Token -> Node/Mark and Serializer mapping tables in docs/wysiwyg-mapping.md for completeness.
- [ ] Review src/wysiwyg/spec.ts for schema coverage and token mapping alignment with markdown-it tokens.
- [ ] Review src/wysiwyg/tokenParser.ts token tree parsing for correct block/inline mapping (marks, containers, includes, tags, media, and html tokens).
- [ ] Review src/wysiwyg/serializer.ts output for headings, lists, tables, includes, containers, and marks (em/strong/underline/strike/mark/sub/sup/ins/link/abbr).
- [ ] Run unit tests for Wysiwyg parser/serializer (`WysiwygParserSerializer.test.ts`) and confirm outputs match expected markdown.
- [ ] Run unit tests for `buildWysiwygSchemaSpec` and confirm text/doc node normalization in `WysiwygSchemaBuilder.test.ts`.
- [ ] Run unit tests for markdown-it adapter (`WysiwygMarkdownItAdapter.test.ts`) covering tags, temporal prefix, wiki links, and include blocks.
- [ ] Run unit tests for WYSIWYG pipeline (`WysiwygPipeline.test.ts`) and confirm round-trip output stays stable for tags + temporal prefix.
- [ ] Enable WYSIWYG editing and confirm task descriptions open with the ProseMirror editor, save back to markdown, and keep include/tag/wiki link nodes visible.
- [ ] Enable WYSIWYG editing and confirm the editor UI actually renders (no blank/hidden editor) and no missing `wysiwyg-editor.js` asset errors appear in the webview console.
- [ ] With WYSIWYG editing active, verify arrow keys, Enter, and Tab behave normally inside the editor and are not intercepted by the textarea handlers.
- [ ] Compare rendered vs WYSIWYG task descriptions and confirm line spacing, list indentation, and padding align closely with the rendered view.
- [ ] Compare task description display vs edit/WYSIWYG line-height for plain text and multiline content (no visible jump when toggling edit).
- [ ] Compare paragraph spacing in task descriptions between display and WYSIWYG edit mode (p margins should match, including top/bottom spacing).
- [ ] Toggle small-card-fonts (layout preset) and confirm task description display + edit/WYSIWYG font styling (size/ligatures) match.
- [ ] In WYSIWYG, double-click an image/audio/video placeholder and confirm the source path can be edited and saves back to markdown.
- [ ] In WYSIWYG, edit a diagram/mermaid code block directly and confirm updates persist on save.
- [ ] In WYSIWYG, click the Edit button on include/media/diagram nodes and confirm the correct edit UI opens or focus moves into the code block.
- [ ] In WYSIWYG, images render with the same burger menu as the display view and the menu actions work (open, reveal, convert path, delete).
- [ ] In WYSIWYG, images with relative paths display correctly (resolved against the main file/include dir) and still open the path menu using the original path.
- [ ] In WYSIWYG, typing text before/after an inline image keeps the image rendered (no fallback to raw markdown).
- [ ] In WYSIWYG, mermaid/plantuml fences render a preview alongside the editable code block.
- [ ] In WYSIWYG, draw.io/excalidraw/pdf image references render the diagram preview (not just the raw filename).
- [ ] In WYSIWYG, typing list markers ("- " or "1. ") converts to lists immediately, and headings convert on "# " input.
- [ ] In WYSIWYG, typing #tag/@person/@2025-01-01/!temporal followed by space converts into tag chips immediately.
- [ ] In WYSIWYG, typing markdown image/link/include/wiki syntax and then continuing to type still keeps the node rendered.
- [ ] In WYSIWYG, typing an image/link/include/wiki tag and then a space should not leave stray ")" characters in the text.
- [ ] In WYSIWYG multicolumn blocks, the add/remove buttons appear as small +/- overlays (top corners) without changing layout height.
- [ ] In WYSIWYG, image-only paragraphs (markdown-it-image-figures/figure tokens) still render as images instead of disappearing.
- [ ] In WYSIWYG, multicolumn blocks render as side-by-side columns with visible separators, and Add/Remove Column buttons update the column count (saved back to ---: :--: :--- markers).
- [ ] In WYSIWYG, typing markdown image/link/include/wiki-link syntax converts immediately to rich nodes, and Backspace right after the node converts back to raw markdown text.
- [ ] In WYSIWYG, Tab inserts two spaces (and indents all selected lines), Shift+Tab unindents selected lines or removes spaces before the cursor, and Alt+Enter saves the edit without Tab ending editing.
